{"id":"worktree-manager-0hx","title":"Epic: Phase 4 - Cross-repo auto-discovery","description":"Implement repo scanning from configured roots and --all mode to list/switch across repositories.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-19T10:26:00.154705+01:00","updated_at":"2025-12-19T11:19:31.51441+01:00","closed_at":"2025-12-19T11:19:31.51441+01:00","close_reason":"Implemented Phase 4 features: auto-discovery, cross-repo list/interactive, and README","dependencies":[{"issue_id":"worktree-manager-0hx","depends_on_id":"worktree-manager-5a3","type":"blocks","created_at":"2025-12-19T10:35:09.431839+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-0r7","title":"Task: README + shell integration docs","description":"Document installation, required deps (git/fzf), shell wrapper function, and common workflows.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T10:26:29.442896+01:00","updated_at":"2025-12-19T11:19:31.513305+01:00","closed_at":"2025-12-19T11:19:31.513305+01:00","close_reason":"Implemented Phase 4 features: auto-discovery, cross-repo list/interactive, and README","dependencies":[{"issue_id":"worktree-manager-0r7","depends_on_id":"worktree-manager-5a3","type":"parent-child","created_at":"2025-12-19T10:28:09.374537+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-114","title":"Task: implement wt preview","description":"Implement 'wt preview --path PATH' that prints repo/branch/path + status summary (git status -sb) + recent commits + changed files summary.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-19T10:29:03.053638+01:00","updated_at":"2025-12-19T10:50:05.569289+01:00","closed_at":"2025-12-19T10:50:05.569289+01:00","close_reason":"implemented wt preview with git status/log/changed files","dependencies":[{"issue_id":"worktree-manager-114","depends_on_id":"worktree-manager-ony","type":"blocks","created_at":"2025-12-19T10:35:07.342909+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-12g","title":"Improve --help text for agent discoverability","description":"Enhance --help output to be more useful for agents discovering the CLI.\n\n## Research Context\n\nFrom beads: Good help text enables agents to learn the CLI without external docs. Beads commands have rich help with examples.\n\nFrom OpenCode: Agents use help text to understand command capabilities. Clear, example-rich help reduces errors.\n\n## Improvements Needed\n\n### 1. Add Examples in Help Text\nUse clap's `#[arg(help = \"...\")]` with examples:\n```\nOptions:\n  --json    Output as JSON for programmatic use\n            Example: wt list --json | jq '.[] | .branch'\n```\n\n### 2. Document JSON Output Formats\nFor commands with --json, describe the output:\n```\n--json    Output as JSON array of worktree objects:\n          [{\"path\": \"...\", \"branch\": \"...\", \"head\": \"...\"}]\n```\n\n### 3. Add See-Also References\n```\nSee also:\n  wt add     - Create new worktree\n  wt remove  - Remove worktree\n  wt prune   - Clean stale worktrees\n```\n\n### 4. Consider `wt help \u003ctopic\u003e`\nExtended help for complex topics:\n- `wt help shell-integration`\n- `wt help json-output`\n- `wt help agent-usage`\n\n## Implementation Notes\n\n- Use clap's after_help for examples section\n- Use clap's about/long_about for descriptions\n- Consider custom help template for consistent formatting","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-19T11:24:55.717764+01:00","updated_at":"2025-12-19T12:48:37.632459+01:00","dependencies":[{"issue_id":"worktree-manager-12g","depends_on_id":"worktree-manager-bsf","type":"blocks","created_at":"2025-12-19T11:25:03.163064+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-1nv","title":"Add shell completions (zsh, bash, fish)","description":"Generate shell completions for all wt commands and subcommands.\n\nUse clap's built-in completion generation to support:\n- zsh completions\n- bash completions  \n- fish completions\n\nCompletions should cover all subcommands and flags.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T11:24:25.270529+01:00","updated_at":"2025-12-19T11:33:42.799116+01:00","closed_at":"2025-12-19T11:33:42.799116+01:00","close_reason":"Shell completions included in 'wt init' output for all three shells","dependencies":[{"issue_id":"worktree-manager-1nv","depends_on_id":"worktree-manager-7nh","type":"blocks","created_at":"2025-12-19T11:24:34.998879+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-2u9","title":"Task: wt prune","description":"Implement 'wt prune' calling 'git worktree prune' (and optional stale listing).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T10:29:03.553932+01:00","updated_at":"2025-12-19T11:06:22.081724+01:00","closed_at":"2025-12-19T11:06:22.081724+01:00","close_reason":"Implemented in this session","dependencies":[{"issue_id":"worktree-manager-2u9","depends_on_id":"worktree-manager-ony","type":"blocks","created_at":"2025-12-19T10:35:08.182242+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-3xx","title":"Task: config read/write skeleton","description":"Implement config loading/saving at config dir. Support editor + autoDiscovery paths + fzf defaults.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T10:26:28.863796+01:00","updated_at":"2025-12-19T11:06:22.075802+01:00","closed_at":"2025-12-19T11:06:22.075802+01:00","close_reason":"Implemented in this session","dependencies":[{"issue_id":"worktree-manager-3xx","depends_on_id":"worktree-manager-4od","type":"parent-child","created_at":"2025-12-19T10:28:08.903825+01:00","created_by":"daemon"},{"issue_id":"worktree-manager-3xx","depends_on_id":"worktree-manager-90v","type":"blocks","created_at":"2025-12-19T10:35:06.770323+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-4c4","title":"Implement interactive 'wt init' that auto-detects shell and offers to add integration to config file","description":"","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T11:46:40.700519+01:00","updated_at":"2025-12-19T11:51:08.224726+01:00","closed_at":"2025-12-19T11:51:08.224726+01:00","close_reason":"Implemented interactive shell setup - wt init now auto-detects shell and offers to modify config file"}
{"id":"worktree-manager-4mv","title":"Add binary releases via GitHub Actions","description":"Set up automated binary releases for multiple platforms.\n\nTargets:\n- macOS (x86_64 and aarch64)\n- Linux (x86_64, aarch64)\n- Windows (x86_64)\n\nUse cargo-dist or goreleaser-style workflow to:\n- Build on tag push\n- Create GitHub releases with binaries\n- Generate checksums","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-19T11:24:29.728596+01:00","updated_at":"2025-12-19T11:24:29.728596+01:00","dependencies":[{"issue_id":"worktree-manager-4mv","depends_on_id":"worktree-manager-7nh","type":"blocks","created_at":"2025-12-19T11:24:35.213288+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-4od","title":"Epic: Phase 1 - Rust CLI skeleton + worktree discovery","description":"Set up Rust project, CLI scaffolding, and parse git worktree porcelain for current repo.","status":"closed","priority":0,"issue_type":"epic","created_at":"2025-12-19T10:26:00.049176+01:00","updated_at":"2025-12-19T11:06:45.460604+01:00","closed_at":"2025-12-19T11:06:45.460604+01:00","close_reason":"Phase 1 complete: CLI skeleton, porcelain parsing, git runner, config, list all implemented"}
{"id":"worktree-manager-5a3","title":"Epic: Phase 3 - Management commands","description":"Implement wt list/add/remove/prune/config and ensure safe UX.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-19T10:26:00.154138+01:00","updated_at":"2025-12-19T11:06:47.620971+01:00","closed_at":"2025-12-19T11:06:47.620971+01:00","close_reason":"Phase 3 complete: add, remove, prune, config commands all implemented","dependencies":[{"issue_id":"worktree-manager-5a3","depends_on_id":"worktree-manager-pfh","type":"blocks","created_at":"2025-12-19T10:35:09.307892+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-5rv","title":"Task: add --all cross-repo interactive","description":"Implement `wt --all` interactive picker. Candidate format should include repo name + branch + path.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T10:26:29.421014+01:00","updated_at":"2025-12-19T11:19:31.512186+01:00","closed_at":"2025-12-19T11:19:31.512186+01:00","close_reason":"Implemented Phase 4 features: auto-discovery, cross-repo list/interactive, and README","dependencies":[{"issue_id":"worktree-manager-5rv","depends_on_id":"worktree-manager-0hx","type":"parent-child","created_at":"2025-12-19T10:28:09.747081+01:00","created_by":"daemon"},{"issue_id":"worktree-manager-5rv","depends_on_id":"worktree-manager-h2l","type":"blocks","created_at":"2025-12-19T10:35:08.82715+01:00","created_by":"daemon"},{"issue_id":"worktree-manager-5rv","depends_on_id":"worktree-manager-ltt","type":"blocks","created_at":"2025-12-19T10:35:08.945976+01:00","created_by":"daemon"},{"issue_id":"worktree-manager-5rv","depends_on_id":"worktree-manager-114","type":"blocks","created_at":"2025-12-19T10:35:09.067805+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-5te","title":"Task: wt config commands","description":"Implement 'wt config init/show/set-editor/set-discovery-paths' per ARCHITECTURE.md.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T10:29:03.686895+01:00","updated_at":"2025-12-19T11:06:22.082634+01:00","closed_at":"2025-12-19T11:06:22.082634+01:00","close_reason":"Implemented in this session","dependencies":[{"issue_id":"worktree-manager-5te","depends_on_id":"worktree-manager-3xx","type":"blocks","created_at":"2025-12-19T10:35:08.324116+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-689","title":"Task: implement wt interactive","description":"Implement interactive picker command: run fzf, show candidates, return action output like 'cd|PATH' or 'edit|PATH'.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-19T10:29:03.177519+01:00","updated_at":"2025-12-19T11:06:22.078495+01:00","closed_at":"2025-12-19T11:06:22.078495+01:00","close_reason":"Implemented in this session","dependencies":[{"issue_id":"worktree-manager-689","depends_on_id":"worktree-manager-ltt","type":"blocks","created_at":"2025-12-19T10:35:07.46587+01:00","created_by":"daemon"},{"issue_id":"worktree-manager-689","depends_on_id":"worktree-manager-114","type":"blocks","created_at":"2025-12-19T10:35:07.586605+01:00","created_by":"daemon"},{"issue_id":"worktree-manager-689","depends_on_id":"worktree-manager-k2q","type":"blocks","created_at":"2025-12-19T10:35:07.698345+01:00","created_by":"daemon"},{"issue_id":"worktree-manager-689","depends_on_id":"worktree-manager-3xx","type":"blocks","created_at":"2025-12-19T10:35:07.818692+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-6o4","title":"Task: implement repository auto-discovery scanner","description":"Scan configured roots (depth-limited) to locate git repositories.\n\nHandle both:\n- `.git/` directories\n- `.git` files (common in worktrees/submodules)\n\nReturn discovered repo roots (deduped).","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T10:26:29.15677+01:00","updated_at":"2025-12-19T11:19:31.508856+01:00","closed_at":"2025-12-19T11:19:31.508856+01:00","close_reason":"Implemented Phase 4 features: auto-discovery, cross-repo list/interactive, and README","dependencies":[{"issue_id":"worktree-manager-6o4","depends_on_id":"worktree-manager-0hx","type":"parent-child","created_at":"2025-12-19T10:28:09.499071+01:00","created_by":"daemon"},{"issue_id":"worktree-manager-6o4","depends_on_id":"worktree-manager-3xx","type":"blocks","created_at":"2025-12-19T10:35:08.459273+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-7nh","title":"Epic: Standalone binary with shell integration built-in","description":"Make wt a standalone binary that doesn't require shell wrappers. Users should be able to install via homebrew and have cd functionality work out of the box.\n\nKey requirements:\n- Eliminate need for shell wrapper function\n- Support installation via homebrew (macOS) and other package managers\n- Binary should handle shell integration automatically\n- Simple 'brew install wt' should give full functionality\n\nInspiration: Tools like 'z' or 'zoxide' that handle shell integration elegantly.","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-19T11:23:56.623666+01:00","updated_at":"2025-12-19T11:24:14.350297+01:00"}
{"id":"worktree-manager-90v","title":"Task: bootstrap Rust CLI project","description":"Create Cargo project for wt/wtm binary. Add deps: clap, anyhow, serde, serde_json, directories. Add basic command structure and --version.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-19T10:26:28.337047+01:00","updated_at":"2025-12-19T10:37:24.065079+01:00","closed_at":"2025-12-19T10:37:24.065079+01:00","close_reason":"cargo project initialized; clap CLI skeleton and deps added","dependencies":[{"issue_id":"worktree-manager-90v","depends_on_id":"worktree-manager-4od","type":"parent-child","created_at":"2025-12-19T10:28:08.556362+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-a87","title":"Add worktree-aware workflows to AGENTS.md for multi-agent scenarios","description":"Document best practices for using worktrees with multiple agents or parallel work sessions.\n\n## Research Context\n\nWorktrees are ideal for AI coding agents because they enable:\n1. **Parallel work** - Multiple agents can work on different features simultaneously\n2. **Isolation** - Each agent has its own working directory\n3. **Context clarity** - Agent knows exactly which branch/feature it's working on\n4. **Easy cleanup** - Remove worktree when work is done\n\n## Recommended Workflows\n\n### 1. One Agent Per Worktree\n```bash\n# Agent 1 works on feature-auth\nwt add feature-auth --json\ncd /path/to/feature-auth-worktree\n# Agent 1 does its work here\n\n# Agent 2 works on feature-api (separate session)\nwt add feature-api --json\ncd /path/to/feature-api-worktree\n# Agent 2 does its work here\n```\n\n### 2. Session Start Pattern\nAt the start of each agent session:\n```bash\nwt agent context  # Understand current worktree state\ngit status        # Verify working directory is clean\n```\n\n### 3. Session End Pattern\nBefore ending a session:\n```bash\ngit status                    # Check for uncommitted changes\nwt list --json               # Verify worktree state\n# If temporary worktree: wt remove \u003cbranch\u003e --quiet\n```\n\n### 4. Avoiding Cross-Worktree Confusion\n- Always verify current worktree at session start\n- Use absolute paths when referencing files\n- Don't cd between worktrees within a session\n\n## Integration with OpenCode\n\nAdd to opencode.json commands:\n```json\n{\n  \"command\": {\n    \"wt-context\": {\n      \"template\": \"Run wt agent context to understand current worktree\",\n      \"description\": \"Get worktree context\"\n    },\n    \"new-feature\": {\n      \"template\": \"Create a new worktree for feature: $ARGUMENTS\",\n      \"description\": \"Start work on a new feature branch\"\n    }\n  }\n}\n```\n\n## Documentation Location\n\nAdd as section in comprehensive AGENTS.md (depends on worktree-manager-rc2)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-19T12:50:01.062602+01:00","updated_at":"2025-12-19T12:50:01.062602+01:00","dependencies":[{"issue_id":"worktree-manager-a87","depends_on_id":"worktree-manager-rc2","type":"blocks","created_at":"2025-12-19T12:50:01.063888+01:00","created_by":"svenlochner"}]}
{"id":"worktree-manager-al9","title":"Add --quiet flag for non-interactive operation","description":"Add --quiet flag to commands that have interactive prompts.\n\n## Research Context\n\nFrom beads: The `--quiet` flag is critical for agent usage. Regular `bd init` has interactive prompts that confuse agents. The `--quiet` flag makes it fully non-interactive:\n```bash\nbd init --quiet  # No prompts, auto-installs hooks, assumes defaults\n```\n\n## Commands Affected\n\n| Command | Interactive Element | --quiet Behavior |\n|---------|---------------------|------------------|\n| `wt remove` | Confirmation prompt | Skip confirmation (assume yes) |\n| `wt init` | ✅ Already non-interactive with shell arg | - |\n| `wt prune` | Could list before pruning | Skip listing, just prune |\n\n## Behavior with --quiet\n\n1. **Suppress informational messages** - No \"Creating worktree...\" type messages\n2. **Skip confirmation prompts** - Assume yes/proceed\n3. **Only output essential data** - Errors or JSON output (if --json also passed)\n4. **Compatible with --json** - `--quiet --json` outputs only JSON, no decoration\n\n## Example Usage\n\n```bash\n# Agent removes worktree without confirmation\nwt remove feature-branch --quiet --json\n\n# Returns only:\n{\"success\": true, \"removed\": {...}}\n\n# Without --quiet, would prompt:\n# Remove worktree 'feature-branch'? (y/N):\n```\n\n## Implementation Notes\n\n- Add `--quiet` or `-q` flag to clap Args structs\n- Check quiet flag before printing informational messages\n- Check quiet flag before prompting for confirmation","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-19T11:24:50.512029+01:00","updated_at":"2025-12-19T12:48:06.496185+01:00","dependencies":[{"issue_id":"worktree-manager-al9","depends_on_id":"worktree-manager-bsf","type":"blocks","created_at":"2025-12-19T11:25:02.942633+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-b3p","title":"Task: tests for porcelain parsing","description":"Add unit tests with fixture outputs for `git worktree list --porcelain` parsing edge cases (detached HEAD, locked, prunable, bare, missing branch).","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T10:26:29.315178+01:00","updated_at":"2025-12-19T11:06:43.933428+01:00","closed_at":"2025-12-19T11:06:43.933428+01:00","close_reason":"Already have tests covering detached HEAD, locked, prunable, bare in worktree.rs","dependencies":[{"issue_id":"worktree-manager-b3p","depends_on_id":"worktree-manager-pfh","type":"parent-child","created_at":"2025-12-19T10:28:09.258648+01:00","created_by":"daemon"},{"issue_id":"worktree-manager-b3p","depends_on_id":"worktree-manager-k2q","type":"blocks","created_at":"2025-12-19T10:35:07.016437+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-b8j","title":"Task: wt remove worktree","description":"Implement 'wt remove' with confirmation (unless --force). Call 'git worktree remove'.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T10:29:03.427652+01:00","updated_at":"2025-12-19T11:06:22.080702+01:00","closed_at":"2025-12-19T11:06:22.080702+01:00","close_reason":"Implemented in this session","dependencies":[{"issue_id":"worktree-manager-b8j","depends_on_id":"worktree-manager-ony","type":"blocks","created_at":"2025-12-19T10:35:08.061383+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-blw","title":"Task: implement wt list (per-repo)","description":"Implement `wt list` for current repo (pretty + --json). Uses porcelain parser.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T10:26:28.7385+01:00","updated_at":"2025-12-19T10:53:19.624549+01:00","closed_at":"2025-12-19T10:53:19.624549+01:00","close_reason":"Implemented wt list per-repo with pretty and json output","dependencies":[{"issue_id":"worktree-manager-blw","depends_on_id":"worktree-manager-4od","type":"parent-child","created_at":"2025-12-19T10:28:09.020199+01:00","created_by":"daemon"},{"issue_id":"worktree-manager-blw","depends_on_id":"worktree-manager-k2q","type":"blocks","created_at":"2025-12-19T10:35:06.893974+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-bsf","title":"Epic: Agent-friendly CLI design","description":"Make wt as compatible and useful for AI agents as possible, following patterns from beads (bd).\n\n## Research Findings (Dec 2024)\n\nAnalyzed beads (bd) and OpenCode to understand best practices for agent-friendly CLI design.\n\n### Key Principles from Beads\n\n1. **JSON Output Everywhere** - Every command supports `--json` for machine-parseable output\n2. **`--quiet` Flag** - Non-interactive mode that skips prompts and suppresses info messages\n3. **Comprehensive AGENTS.md** - ~600 lines covering workflows, examples, JSON schemas\n4. **`bd prime` Pattern** - Injects compact workflow context (~1-2k tokens) for agents\n5. **Structured Errors** - Consistent error format with categories for programmatic handling\n6. **Git Hooks** - Auto-sync without manual intervention\n\n### Integration with OpenCode/SST\n\nOpenCode reads AGENTS.md on `/init` to understand projects. Key integration points:\n- Custom tools in `.opencode/tool/` can wrap wt commands\n- Custom commands for repetitive worktree operations\n- AGENTS.md is the primary way agents discover CLI capabilities\n\n### Design Goals\n\n- Minimize context usage (CLI is more efficient than MCP)\n- No interactive prompts (use `--quiet` or `--yes` flags)\n- Clear, structured output for both humans and machines\n- Self-documenting help text with examples\n\nReference: https://github.com/steveyegge/beads","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-19T11:24:42.036717+01:00","updated_at":"2025-12-19T12:47:04.795537+01:00"}
{"id":"worktree-manager-d66","title":"Set up Homebrew formula for distribution","description":"Create Homebrew formula for easy macOS installation.\n\nRequirements:\n- Create homebrew tap repository or submit to homebrew-core\n- Formula should build from source or download prebuilt binary\n- Include post-install message about shell init\n- Test on Intel and Apple Silicon Macs\n\nUsage goal: brew install wt","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-19T11:24:27.622938+01:00","updated_at":"2025-12-19T11:24:27.622938+01:00","dependencies":[{"issue_id":"worktree-manager-d66","depends_on_id":"worktree-manager-7nh","type":"blocks","created_at":"2025-12-19T11:24:35.107036+01:00","created_by":"daemon"},{"issue_id":"worktree-manager-d66","depends_on_id":"worktree-manager-4mv","type":"blocks","created_at":"2025-12-19T11:24:36.05658+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-e13","title":"Implement 'wt init' shell integration command","description":"Add 'wt init \u003cshell\u003e' command that outputs shell code for integration.\n\nUsage pattern:\n  eval \"$(wt init zsh)\"    # in ~/.zshrc\n  eval \"$(wt init bash)\"   # in ~/.bashrc\n  wt init fish | source      # in ~/.config/fish/config.fish\n\nThe init command should:\n- Output minimal shell function that wraps wt\n- Handle cd/edit action parsing\n- Support zsh, bash, fish shells\n- Include shell completions","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T11:24:23.444927+01:00","updated_at":"2025-12-19T11:33:41.553786+01:00","closed_at":"2025-12-19T11:33:41.553786+01:00","close_reason":"Implemented 'wt init \u003cshell\u003e' with shell wrapper functions and completions for zsh, bash, fish","dependencies":[{"issue_id":"worktree-manager-e13","depends_on_id":"worktree-manager-7nh","type":"blocks","created_at":"2025-12-19T11:24:34.890155+01:00","created_by":"daemon"},{"issue_id":"worktree-manager-e13","depends_on_id":"worktree-manager-z95","type":"blocks","created_at":"2025-12-19T11:24:35.360444+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-elm","title":"Add OpenCode custom tool example to documentation","description":"Provide an example of how to integrate wt with OpenCode using custom tools.\n\n## Research Context\n\nOpenCode supports custom tools defined in `.opencode/tool/` that can wrap CLI commands. This allows agents to use wt commands as native tools.\n\n## Example: .opencode/tool/worktree.ts\n\n```typescript\nimport { tool } from \"@opencode-ai/plugin\"\n\nexport const list = tool({\n  description: \"List git worktrees in current repository\",\n  args: {\n    all: tool.schema.boolean().optional().describe(\"List across all discovered repos\"),\n  },\n  async execute(args) {\n    const flags = args.all ? '--all' : ''\n    const result = await Bun.$`wt list ${flags} --json`.text()\n    return result.trim()\n  },\n})\n\nexport const switch_to = tool({\n  description: \"Switch to a different git worktree\",\n  args: {\n    branch: tool.schema.string().describe(\"Branch name or worktree path\"),\n  },\n  async execute(args) {\n    // Return cd action for shell integration\n    const worktrees = JSON.parse(await Bun.$`wt list --json`.text())\n    const target = worktrees.find(w =\u003e w.branch === args.branch || w.path.includes(args.branch))\n    if (!target) return `Worktree not found: ${args.branch}`\n    return `cd|${target.path}`\n  },\n})\n\nexport const create = tool({\n  description: \"Create a new git worktree for a branch\",\n  args: {\n    branch: tool.schema.string().describe(\"Branch name to create worktree for\"),\n    path: tool.schema.string().optional().describe(\"Custom path for worktree\"),\n  },\n  async execute(args) {\n    const pathFlag = args.path ? `-p ${args.path}` : ''\n    const result = await Bun.$`wt add ${args.branch} ${pathFlag} --json`.text()\n    return result.trim()\n  },\n})\n\nexport const context = tool({\n  description: \"Get current worktree context for understanding project layout\",\n  args: {},\n  async execute() {\n    const result = await Bun.$`wt agent context`.text()\n    return result.trim()\n  },\n})\n```\n\n## Documentation Location\n\nAdd to README.md under \"Integration with Coding Agents\" section:\n- Explain custom tool pattern\n- Provide the example above\n- Link to OpenCode docs\n\nAlso add to AGENTS.md for agent discoverability.\n\n## Benefits\n\n1. Agents can use wt as native tools\n2. No MCP server complexity\n3. Works with OpenCode's permission system\n4. Leverages existing --json output","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-19T12:49:40.074224+01:00","updated_at":"2025-12-19T12:49:40.074224+01:00","dependencies":[{"issue_id":"worktree-manager-elm","depends_on_id":"worktree-manager-bsf","type":"blocks","created_at":"2025-12-19T12:49:40.075627+01:00","created_by":"svenlochner"}]}
{"id":"worktree-manager-h2l","title":"Task: add --all cross-repo list","description":"Implement `wt list --all` to aggregate worktrees across discovered repos (and --json).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T10:26:29.29064+01:00","updated_at":"2025-12-19T11:19:31.510941+01:00","closed_at":"2025-12-19T11:19:31.510941+01:00","close_reason":"Implemented Phase 4 features: auto-discovery, cross-repo list/interactive, and README","dependencies":[{"issue_id":"worktree-manager-h2l","depends_on_id":"worktree-manager-0hx","type":"parent-child","created_at":"2025-12-19T10:28:09.629901+01:00","created_by":"daemon"},{"issue_id":"worktree-manager-h2l","depends_on_id":"worktree-manager-6o4","type":"blocks","created_at":"2025-12-19T10:35:08.589314+01:00","created_by":"daemon"},{"issue_id":"worktree-manager-h2l","depends_on_id":"worktree-manager-k2q","type":"blocks","created_at":"2025-12-19T10:35:08.710655+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-hhh","title":"Implement 'wt agent' subcommand for agent context injection","description":"Add a `wt agent` subcommand similar to beads' `bd prime` pattern for injecting compact workflow context into agent sessions.\n\n## Research Context\n\nFrom beads: The `bd prime` command outputs a compact workflow reference (~1-2k tokens) that can be injected into agent context. This is more efficient than MCP (which adds tool schemas to context) and provides agents with essential information upfront.\n\n```bash\nbd prime  # Outputs compact workflow context for agents\n```\n\n## Proposed Commands\n\n### `wt agent context`\nOutput compact context about current worktree state for agents:\n\n```bash\nwt agent context [--json]\n```\n\nOutput includes:\n- Current worktree info (path, branch, status)\n- Other worktrees in this repo\n- Quick command reference\n- Common workflows\n\nExample output:\n```\n## Worktree Context\n\nCurrent: feature-auth @ /Users/dev/myproject-feature-auth\nBranch: feature-auth (3 commits ahead of main)\nStatus: 2 modified, 1 untracked\n\nOther worktrees:\n- main @ /Users/dev/myproject (clean)\n- develop @ /Users/dev/myproject-develop (dirty)\n\nQuick commands:\n- wt              # Interactive picker\n- wt list --json  # List all worktrees\n- wt add \u003cbranch\u003e # Create new worktree\n- wt remove       # Remove worktree\n```\n\n### `wt agent status` (optional)\nMinimal status suitable for frequent injection:\n\n```bash\nwt agent status [--json]\n```\n\nReturns just:\n```json\n{\n  \"current\": {\n    \"path\": \"/path/to/worktree\",\n    \"branch\": \"feature-x\",\n    \"dirty\": true\n  },\n  \"count\": 3\n}\n```\n\n## Use Cases\n\n1. **Session Start** - Agent runs `wt agent context` to understand worktree layout\n2. **OpenCode Integration** - Can be added to AGENTS.md or custom commands\n3. **Claude Code hooks** - Similar to bd's SessionStart hook pattern\n4. **Context Refresh** - Quick status check during long sessions\n\n## Implementation Notes\n\n- Create new `src/agent.rs` module\n- Add `Agent` subcommand to CLI\n- Keep output concise (~1-2k tokens max)\n- Support both human-readable and JSON output\n- Consider caching for performance","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-19T12:49:15.50396+01:00","updated_at":"2025-12-19T12:49:15.50396+01:00","dependencies":[{"issue_id":"worktree-manager-hhh","depends_on_id":"worktree-manager-bsf","type":"blocks","created_at":"2025-12-19T12:49:15.505251+01:00","created_by":"svenlochner"}]}
{"id":"worktree-manager-hqo","title":"Add --json flag to all commands","description":"Ensure all wt commands support --json output for programmatic use by agents.\n\n## Research Context\n\nFrom beads: Every command returns structured JSON when `--json` is passed. This is critical for agents to parse output programmatically. Beads uses this pattern consistently:\n```bash\nbd ready --json          # Returns array of ready issues\nbd create \"Title\" --json # Returns created issue object\nbd close \u003cid\u003e --json     # Returns closed issue confirmation\n```\n\n## Commands to Update\n\n| Command | Current | Needed |\n|---------|---------|--------|\n| `wt list` | ✅ Has --json | - |\n| `wt add` | ❌ Text only | Return created worktree as JSON |\n| `wt remove` | ❌ Text only | Return removed worktree info as JSON |\n| `wt prune` | ❌ Text only | Return list of pruned worktrees as JSON |\n| `wt config show` | Outputs TOML | Add --json option |\n| `wt preview` | ❌ Text only | Return preview data as JSON |\n\n## JSON Schema Examples\n\n### wt add --json\n```json\n{\n  \"success\": true,\n  \"worktree\": {\n    \"path\": \"/path/to/worktree\",\n    \"branch\": \"feature-x\",\n    \"head\": \"abc1234\",\n    \"is_main\": false\n  }\n}\n```\n\n### wt remove --json\n```json\n{\n  \"success\": true,\n  \"removed\": {\n    \"path\": \"/path/to/worktree\",\n    \"branch\": \"feature-x\"\n  }\n}\n```\n\n### wt prune --json\n```json\n{\n  \"pruned\": [\n    {\"path\": \"/stale/worktree1\", \"reason\": \"missing\"},\n    {\"path\": \"/stale/worktree2\", \"reason\": \"locked\"}\n  ],\n  \"count\": 2\n}\n```\n\n## Implementation Notes\n\n- Use serde_json for serialization (already a dependency)\n- Reuse existing Worktree struct with #[derive(Serialize)]\n- Ensure --json suppresses human-friendly messages","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-19T11:24:47.925016+01:00","updated_at":"2025-12-19T12:47:57.074925+01:00","dependencies":[{"issue_id":"worktree-manager-hqo","depends_on_id":"worktree-manager-bsf","type":"blocks","created_at":"2025-12-19T11:25:02.833972+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-jlb","title":"Epic: worktree-manager v0.1","description":"Deliver first usable version of wt (rust + git + fzf) with per-repo interactive switching and basic management commands, plus optional cross-repo auto-discovery support.","status":"closed","priority":0,"issue_type":"epic","created_at":"2025-12-19T10:25:55.265868+01:00","updated_at":"2025-12-19T11:19:46.584732+01:00","closed_at":"2025-12-19T11:19:46.584732+01:00","close_reason":"v0.1 complete: all phases implemented (CLI skeleton, interactive mode, management commands, cross-repo discovery)","dependencies":[{"issue_id":"worktree-manager-jlb","depends_on_id":"worktree-manager-4od","type":"parent-child","created_at":"2025-12-19T10:27:57.998747+01:00","created_by":"daemon"},{"issue_id":"worktree-manager-jlb","depends_on_id":"worktree-manager-pfh","type":"parent-child","created_at":"2025-12-19T10:27:58.119873+01:00","created_by":"daemon"},{"issue_id":"worktree-manager-jlb","depends_on_id":"worktree-manager-5a3","type":"parent-child","created_at":"2025-12-19T10:27:58.239248+01:00","created_by":"daemon"},{"issue_id":"worktree-manager-jlb","depends_on_id":"worktree-manager-0hx","type":"parent-child","created_at":"2025-12-19T10:27:58.349941+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-k2q","title":"Task: parse git worktree porcelain","description":"Parse `git worktree list --porcelain` output into Rust structs (path, branch, head, bare, locked, prunable, etc.).\n\nAcceptance:\n- Parser handles multiple worktrees\n- Branch may be missing (detached HEAD)\n- Output is round-trippable in tests","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-19T10:26:28.605284+01:00","updated_at":"2025-12-19T10:46:42.912229+01:00","closed_at":"2025-12-19T10:46:42.912229+01:00","close_reason":"added porcelain parser + basic unit tests","dependencies":[{"issue_id":"worktree-manager-k2q","depends_on_id":"worktree-manager-4od","type":"parent-child","created_at":"2025-12-19T10:28:08.78914+01:00","created_by":"daemon"},{"issue_id":"worktree-manager-k2q","depends_on_id":"worktree-manager-ony","type":"blocks","created_at":"2025-12-19T10:35:06.652421+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-lbw","title":"Add machine-readable error output","description":"Ensure errors are machine-parseable for agent error handling.\n\n## Research Context\n\nFrom beads: Structured errors allow agents to programmatically handle and recover from failures. Beads uses consistent error formats with categories.\n\n## Requirements\n\n### 1. Consistent Error Format with --json\n```json\n{\n  \"error\": true,\n  \"code\": \"not_found\",\n  \"message\": \"Worktree 'feature-x' not found\",\n  \"details\": {\n    \"searched_path\": \"/path/to/repo\",\n    \"available\": [\"main\", \"develop\"]\n  }\n}\n```\n\n### 2. Error Categories\n| Code | Meaning | Exit Code |\n|------|---------|-----------|\n| `user_error` | Invalid input/usage | 1 |\n| `not_found` | Worktree/branch not found | 2 |\n| `git_error` | Git command failed | 3 |\n| `config_error` | Configuration issue | 4 |\n| `io_error` | File system error | 5 |\n\n### 3. Clear Exit Codes\n- 0: Success\n- 1: User error (bad arguments, invalid usage)\n- 2: Not found (worktree, branch, repo)\n- 3: Git error (git command failed)\n- 4: Config error (missing/invalid config)\n- 5: I/O error (file system issues)\n\n### 4. Structured Error Messages\nEven without --json, errors should be parseable:\n```\nerror[not_found]: Worktree 'feature-x' not found\n  --\u003e searched in /path/to/repo\n  = available: main, develop\n```\n\n## Implementation Notes\n\n- Create custom error types with thiserror\n- Implement Serialize for error types\n- Use consistent exit codes via std::process::exit\n- Consider anyhow for error context chaining","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-19T11:24:58.218645+01:00","updated_at":"2025-12-19T12:48:47.059852+01:00","dependencies":[{"issue_id":"worktree-manager-lbw","depends_on_id":"worktree-manager-bsf","type":"blocks","created_at":"2025-12-19T11:25:03.27364+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-ltt","title":"Task: implement fzf integration","description":"Spawn external fzf, feed candidates via stdin, capture selected line. Support preview command invocation.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-19T10:26:28.439804+01:00","updated_at":"2025-12-19T11:06:22.077357+01:00","closed_at":"2025-12-19T11:06:22.077357+01:00","close_reason":"Implemented in this session","dependencies":[{"issue_id":"worktree-manager-ltt","depends_on_id":"worktree-manager-pfh","type":"parent-child","created_at":"2025-12-19T10:28:09.138804+01:00","created_by":"daemon"},{"issue_id":"worktree-manager-ltt","depends_on_id":"worktree-manager-90v","type":"blocks","created_at":"2025-12-19T10:35:07.126128+01:00","created_by":"daemon"},{"issue_id":"worktree-manager-ltt","depends_on_id":"worktree-manager-ony","type":"blocks","created_at":"2025-12-19T10:35:07.230828+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-nxg","title":"Task: wt add worktree","description":"Implement 'wt add BRANCH' (optional -p PATH, --track REMOTE). Decide default path naming convention.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T10:29:03.304318+01:00","updated_at":"2025-12-19T11:06:22.079618+01:00","closed_at":"2025-12-19T11:06:22.079618+01:00","close_reason":"Implemented in this session","dependencies":[{"issue_id":"worktree-manager-nxg","depends_on_id":"worktree-manager-ony","type":"blocks","created_at":"2025-12-19T10:35:07.938557+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-ony","title":"Task: implement git command runner","description":"Add a small wrapper around std::process::Command for running git (and fzf) with proper error messages and captured stdout/stderr.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-19T10:26:28.474606+01:00","updated_at":"2025-12-19T10:42:10.094562+01:00","closed_at":"2025-12-19T10:42:10.094562+01:00","close_reason":"added src/process.rs command runner and refactored main into modules","dependencies":[{"issue_id":"worktree-manager-ony","depends_on_id":"worktree-manager-4od","type":"parent-child","created_at":"2025-12-19T10:28:08.67271+01:00","created_by":"daemon"},{"issue_id":"worktree-manager-ony","depends_on_id":"worktree-manager-90v","type":"blocks","created_at":"2025-12-19T10:35:06.548002+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-pfh","title":"Epic: Phase 2 - Interactive wt via fzf","description":"Implement interactive picker using external fzf + rich preview via wt preview.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-19T10:26:00.049887+01:00","updated_at":"2025-12-19T11:06:46.351336+01:00","closed_at":"2025-12-19T11:06:46.351336+01:00","close_reason":"Phase 2 complete: fzf integration, interactive picker, preview implemented","dependencies":[{"issue_id":"worktree-manager-pfh","depends_on_id":"worktree-manager-4od","type":"blocks","created_at":"2025-12-19T10:35:09.188331+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-rc2","title":"Create comprehensive AGENTS.md for wt","description":"Create an AGENTS.md file following the beads pattern to guide AI agents.\n\n## Research Context\n\nBeads has an extensive AGENTS.md (~600 lines) that serves as the primary documentation for AI agents. OpenCode reads AGENTS.md on `/init` to understand project structure and workflows.\n\nKey sections from beads AGENTS.md:\n1. Project Overview - What the tool does\n2. Quick Start - Essential commands\n3. CLI Quick Reference - All commands with examples\n4. Workflow - Step-by-step usage patterns\n5. JSON Output Documentation - Schema examples\n6. Error Handling - How to handle failures\n7. \"Landing the Plane\" - Session completion checklist\n\n## Recommended Structure for wt AGENTS.md\n\n### 1. Project Overview\n- What wt does (git worktree manager)\n- Core use case (fast switching between worktrees)\n\n### 2. Build/Test Commands\n- cargo build, cargo test, cargo clippy, cargo fmt\n\n### 3. Quick Command Reference\n```bash\nwt                      # Interactive picker (fzf)\nwt list [--json]        # List worktrees\nwt add \u003cbranch\u003e         # Create worktree\nwt remove \u003cworktree\u003e    # Remove worktree\nwt prune                # Clean stale worktrees\nwt agent context        # Get agent-friendly context\n```\n\n### 4. Workflow Examples\n- Switching to existing worktree\n- Creating worktree for new feature\n- Cleaning up after PR merge\n- Cross-repo worktree management\n\n### 5. JSON Output Schemas\n- Document all --json output formats\n- Include example outputs\n\n### 6. Integration with Coding Agents\n- How to use wt from OpenCode/Claude Code\n- Shell integration setup\n- Best practices\n\n### 7. Session Completion\n- Similar to beads \"Landing the Plane\"\n- Ensure worktree state is clean before ending\n\n## Reference\n\nBeads AGENTS.md: https://github.com/steveyegge/beads/blob/main/AGENTS.md","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-19T11:24:52.778449+01:00","updated_at":"2025-12-19T12:48:28.413176+01:00","dependencies":[{"issue_id":"worktree-manager-rc2","depends_on_id":"worktree-manager-bsf","type":"blocks","created_at":"2025-12-19T11:25:03.0526+01:00","created_by":"daemon"}]}
{"id":"worktree-manager-uoj","title":"Implement worktree-manager CLI tool","description":"Build a CLI tool that manages git worktrees for the current repository.\n\nKey features:\n- wt (interactive): fzf-based picker for switching between worktrees\n- wt list: List all worktrees for current repo\n- wt add \u003cbranch\u003e: Create new worktree\n- wt remove \u003cworktree\u003e: Remove worktree\n- wt config: Manage configuration\n\nSee DESIGN.md for full specification.","status":"closed","priority":0,"issue_type":"feature","created_at":"2025-12-19T10:15:22.998202+01:00","updated_at":"2025-12-19T11:19:46.586613+01:00","closed_at":"2025-12-19T11:19:46.586613+01:00","close_reason":"v0.1 complete: all phases implemented (CLI skeleton, interactive mode, management commands, cross-repo discovery)"}
{"id":"worktree-manager-z95","title":"Research shell integration patterns (zoxide, starship)","description":"Research how tools like zoxide, starship, and similar handle shell integration elegantly.\n\nGoals:\n- Understand how zoxide provides 'cd' functionality without wrappers\n- Study starship's init command pattern\n- Document options: eval-based init, shell plugin, completions\n- Recommend best approach for wt","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T11:24:20.308378+01:00","updated_at":"2025-12-19T11:33:43.465497+01:00","closed_at":"2025-12-19T11:33:43.465497+01:00","close_reason":"Research complete - implemented zoxide-style eval pattern","dependencies":[{"issue_id":"worktree-manager-z95","depends_on_id":"worktree-manager-7nh","type":"blocks","created_at":"2025-12-19T11:24:34.780759+01:00","created_by":"daemon"}]}
